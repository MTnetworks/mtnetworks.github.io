**1. 首先检查浏览器代理配置**
在浏览器中查看当前使用的代理：
Chrome/Edge: chrome://settings/help → 关于 → 代理设置
或直接查看系统代理设置
**2. 为命令行设置代理**
Windows (CMD/PowerShell):
```
cmd
# 临时设置（当前会话有效）
set http_proxy=http://127.0.0.1:1080
set https_proxy=http://127.0.0.1:1080

# 或在 PowerShell 中
$env:HTTP_PROXY="http://127.0.0.1:1080"
$env:HTTPS_PROXY="http://127.0.0.1:1080"
```
Windows 设置永久代理：
```
cmd
# 添加到系统环境变量
setx HTTP_PROXY "http://127.0.0.1:1080"
setx HTTPS_PROXY "http://127.0.0.1:1080"
```
Linux/Mac:
```
# 临时设置
export http_proxy=http://127.0.0.1:1080
export https_proxy=http://127.0.0.1:1080

# 永久设置（添加到 ~/.bashrc 或 ~/.zshrc）
echo 'export http_proxy=http://127.0.0.1:1080' >> ~/.bashrc
echo 'export https_proxy=http://127.0.0.1:1080' >> ~/.bashrc
source ~/.bashrc
```
**3. 如果使用 SOCKS5 代理（如 Clash/V2Ray）**
```
# 使用 curl 的 --socks5 参数
curl --socks5 127.0.0.1:1080 https://github.com

# 或设置 all_proxy（适用于 SOCKS）
export all_proxy=socks5://127.0.0.1:1080
```
**4. 专门为 Git 配置代理**
```
# HTTP/HTTPS 代理
git config --global http.proxy http://127.0.0.1:1080
git config --global https.proxy http://127.0.0.1:1080

# SOCKS5 代理
git config --global http.proxy socks5://127.0.0.1:1080
git config --global https.proxy socks5://127.0.0.1:1080

# 取消代理
git config --global --unset http.proxy
git config --global --unset https.proxy
```
**5. 验证代理是否生效**
```
# 测试连接
curl -v https://github.com

# 查看代理是否使用
curl -v --proxy http://127.0.0.1:1080 https://github.com

# 查看 IP（确认代理生效）
curl https://api.ipify.org?format=json
```
**6. 常见问题排查**
A. 代理地址/端口不正确
检查代理软件的实际端口

常见端口：1080, 10808, 7890, 8888
B. 代理需要认证
```
# 如果有用户名密码
export http_proxy=http://username:password@127.0.0.1:1080
```
C. 某些工具需要特殊配置
```
# apt (Ubuntu/Debian)
echo 'Acquire::http::Proxy "http://127.0.0.1:1080";' | sudo tee /etc/apt/apt.conf.d/proxy.conf

# npm
npm config set proxy http://127.0.0.1:1080
npm config set https-proxy http://127.0.0.1:1080

# yarn
yarn config set proxy http://127.0.0.1:1080
yarn config set https-proxy http://127.0.0.1:1080
```
**7. Windows 特殊处理**
如果上述方法无效，尝试：
```
powershell
# 1. 以管理员身份运行命令行
# 2. 重置网络
netsh winhttp reset proxy

# 3. 或直接设置 WinHTTP 代理（影响系统级别）
netsh winhttp set proxy 127.0.0.1:1080
```
**8. 快捷检测脚本**
创建测试脚本 test_proxy.sh：
```
#!/bin/bash
echo "Testing proxy connection..."
echo "1. Without proxy:"
curl -s --connect-timeout 5 https://github.com | grep -o "<title>.*</title>"

echo -e "\n2. With proxy:"
curl -s --proxy http://127.0.0.1:1080 --connect-timeout 5 https://github.com | grep -o "<title>.*</title>"

echo -e "\n3. Current public IP:"
curl --proxy http://127.0.0.1:1080 -s https://api.ipify.org
```
